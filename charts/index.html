<!DOCTYPE html>
<html>
  <head>
    <script src="http://code.jquery.com/jquery-latest.min.js"></script>
    <script src="http://code.highcharts.com/highcharts.js"></script>
    <script src="http://code.highcharts.com/highcharts-more.js"></script>
    <script src="http://code.highcharts.com/modules/exporting.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tabletop.js/1.3.5/tabletop.min.js"></script>
    <script>

        createSubData = function(num,name){
            return {
                name:name,
                y: num
            }
        }

        yearNames = ['1970','1990','2016']
        valuesBig = [[40,14,9,0,8],[53,8,20,10,2],[33,32,19,14,1]]
        names = ["Coal","Nateral gas","nuclear","renewable","Other"]
                    

        function showData(yearI){
            console.log(yearI)

            year = yearNames[yearI]
            values = valuesBig[yearI]
            var data = []
            for (var i =0; i< values.length; i++) {
                data.push(createSubData(values[i],names[i]))
            }
            $('#container').highcharts({
                chart: {
                    type: 'pie'
                },
                title: {
                    text: ('Percentage of energy usage ' + year)
                },
                series: [{
                    name: 'energy',
                    colorByPoint: true,
                    data:data
                }]
            });
            console.log("here")            
        }

        $(function () {
            yearI = 0;
            
            showData(yearI++);
            setInterval(function(){
                showData(yearI++ %  yearNames.length);
            },3000)
        });


            


    </script>
  </head>
  <body>
    <div id="container" style="min-width: 310px; height: 400px; margin: 0 auto"></div>
  </body>
</html>
